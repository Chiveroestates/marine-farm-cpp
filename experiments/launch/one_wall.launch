<launch>
  <!-- Launchfile arguments -->
  <arg name="rviz" value="true" />
  <arg name="display_img_gp" value="true" />
  <arg name="display_cov_gp" value="true" />

  <!-- ROS parameters -->
  <rosparam file="$(find farm_simulator)/config/farm_simulator.yaml" command="load" />
  <rosparam file="$(find robot_simulator)/config/robot_simulator.yaml" command="load" />
  <rosparam file="$(find sensors_simulator)/config/sensors_simulator.yaml" command="load" />
  <rosparam file="$(find mf_mapping)/config/mapping.yaml" command="load" />
  <rosparam file="$(find experiments)/config/one_wall.yaml" command="load" />

  <!-- Static transforms -->
  <node pkg="tf2_ros" type="static_transform_publisher" name="tf_world_ocean" args="0 0 0 0 0 3.14159265359 world ocean" />
  <node pkg="tf2_ros" type="static_transform_publisher" name="tf_world_wall" args="0 0 -2.1 0 1.5707963267948966 0 world wall" />
  <node pkg="tf2_ros" type="static_transform_publisher" name="tf_base_camera" args="0 0 0 0 0 1.5707963267948966 base_link camera" />

  <!-- Simulation -->
  <node pkg="nodelet" type="nodelet" args="manager" name="simu_nodelet_manager" output="screen" />

  <node pkg="nodelet" type="nodelet" args="load farm_simulator/FarmNodelet simu_nodelet_manager"
    name="farm_nodelet" output="screen" />
  <node pkg="nodelet" type="nodelet" args="load sensors_simulator/CameraNodelet simu_nodelet_manager"
    name="camera_nodelet" output="screen" required="true">
    <remap from="/camera_nodelet/algae" to="/farm_nodelet/algae" />
  </node>

  <node name="robot_simulator" type="robot_simulator" pkg="robot_simulator"
    output="screen" />

  <!-- Navigation planner -->
  <node pkg="nodelet" type="nodelet" args="manager" name="nav_nodelet_manager" output="screen" />

  <node pkg="nodelet" type="nodelet" args="load mf_mapping/GPNodelet nav_nodelet_manager"
    name="gp_nodelet" output="screen" />

  <!-- Visualisation -->
  <node type="rviz" name="rviz" pkg="rviz" args="-d $(find farm_simulator)/rviz/farm_simulator.rviz" if="$(arg rviz)" />

  <node type="image_view" name="display_img_gp" pkg="image_view" if="$(arg display_img_gp)">
    <remap from="image" to="gp_img" />
  </node>
  <node type="image_view" name="display_cov_gp" pkg="image_view" if="$(arg display_cov_gp)">
    <remap from="image" to="gp_cov" />
  </node>

</launch>
